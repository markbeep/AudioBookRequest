{#def
    user: DetailedUser,
    recommendations: list[AudiobookRecommendations],
    page: int,
    per_page: int,
    has_next: bool,
    total_items: int,
    region_tld: str,
    auto_start_download: bool
#}

<BaseLayout title="For You" user={{ user }}>
<script>
    const onPageChange = page => {
        const url = new URL(window.location);
        url.searchParams.set("page", page);
        window.location = url;
    };
</script>

<div class="w-screen flex flex-col items-center justify-center p-6 sm:p-8 overflow-x-hidden gap-6">
    <div class="w-full max-w-7xl flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-bold">
                For You
            </h1>
            <p class="opacity-70">
                Personalized picks based on your requests
                {% if has_next %}
                    , showing {{
                    recommendations|length }}
                    of {{ total_items }}
                {% endif %}
            </p>
        </div>
        <a href="{{ base_url }}/search"
           class="btn btn-primary flex items-center gap-2"
           title="Search for books">
            Search
            <icons.Search />
        </a>
    </div>
    <div class="w-full max-w-7xl">
        {% if recommendations %}
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
                {% for rec in recommendations %}
                    <BookCard book_with_requests={{ rec.book }} region_tld={{ region_tld }} auto_start_download={{ auto_start_download }} user={{ user }} />
                {% endfor %}
            </div>
        {% else %}
            <div class="text-center py-16">
                <h3 class="text-2xl font-semibold mt-2">
                    No personalized recommendations yet
                </h3>
                <p class="opacity-70 mt-1">
                    Request a few audiobooks to help us learn your tastes.
                </p>
                <a href="{{ base_url }}/search" class="btn btn-primary mt-4">Search for Books</a>
            </div>
        {% endif %}
    </div>
    {% if recommendations or page > 0 %}
        <div class="join">
            <button class="join-item btn"
                    onclick="onPageChange('{{ page-1 }}')"
                    {% if page.__eq__(1) %}disabled{% endif %}>
                «
            </button>
            <button class="join-item btn flex flex-col gap-0"
                    onclick="onPageChange('{{ 1 }}')"
                    {% if page.__eq__(1) %}disabled{% endif %}>
                Page {{ page }}
                <span class="text-[0.5rem]">back to first</span>
            </button>
            <button class="join-item btn"
                    {% if not has_next %}disabled{% endif %}
                    onclick="onPageChange('{{ page+1 }}')">
                »
            </button>
        </div>
    {% endif %}
</div>
</BaseLayout>
