{% extends "settings_page/base.html" %}
{% block head %}
<title>Settings - Media Management</title>
{% endblock head %}
{% block content %}
<div class="app-card app-panel flex flex-col gap-4 app-stagger">
    <h2 class="text-lg">Media Management</h2>
    <p class="text-sm opacity-70 mb-4">Configure how books are processed, moved, and renamed after downloading.</p>

    {% block media_form %}
    <form class="flex flex-col gap-4" 
          hx-put="{{ base_url }}/settings/media-management"
          hx-target="this"
          hx-swap="outerHTML">
        {% if success %}<script>toast("{{success|safe}}", "success");</script>{% endif %}
        <div class="flex flex-col w-full">
            <label for="library-path" class="font-bold">Library Root Path</label>
            <input id="library-path" name="library_path" type="text" value="{{ library_path or '' }}" placeholder="/mnt/audiobooks" class="input w-full" required />
            <p class="text-xs opacity-60">The base directory where your audiobook library is stored.</p>
        </div>

        <div class="flex flex-col w-full">
            <label for="folder-pattern" class="font-bold">Folder Pattern</label>
            <input id="folder-pattern" name="folder_pattern" type="text" value="{{ folder_pattern }}" class="input w-full" required />
            <div class="text-[10px] opacity-60 mt-1">
                Available tags: <span class="badge badge-xs">{author}</span> <span class="badge badge-xs">{title}</span> <span class="badge badge-xs">{series}</span> <span class="badge badge-xs">{series_index}</span> <span class="badge badge-xs">{year}</span> <span class="badge badge-xs">{asin}</span>
            </div>
            <p class="text-xs opacity-60">Example: {author}/{series}/{title} ({year})</p>
        </div>

        <div class="flex flex-col w-full">
            <label for="file-pattern" class="font-bold">File Naming Pattern</label>
            <input id="file-pattern" name="file_pattern" type="text" value="{{ file_pattern }}" class="input w-full" required />
            <div class="text-[10px] opacity-60 mt-1">
                Available tags: <span class="badge badge-xs">{author}</span> <span class="badge badge-xs">{title}</span> <span class="badge badge-xs">{series}</span> <span class="badge badge-xs">{series_index}</span> <span class="badge badge-xs">{year}</span> <span class="badge badge-xs">{asin}</span> <span class="badge badge-xs">{part}</span>
            </div>
            <p class="text-xs opacity-60">Example: {title} - {part}</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="form-control">
                <label class="label cursor-pointer justify-start gap-4">
                    <input type="checkbox" name="use_series_folders" class="checkbox checkbox-primary" {% if use_series_folders %}checked{% endif %} />
                    <span class="label-text font-bold">Use Series Folders</span>
                </label>
                <p class="text-[10px] opacity-60">Organize books into series subfolders automatically.</p>
            </div>

            <div class="form-control">
                <label class="label cursor-pointer justify-start gap-4">
                    <input type="checkbox" name="use_hardlinks" class="checkbox checkbox-primary" {% if use_hardlinks %}checked{% endif %} />
                    <span class="label-text font-bold">Use Hardlinks</span>
                </label>
                <p class="text-[10px] opacity-60">Save space by hardlinking files (same filesystem only).</p>
            </div>
        </div>

        <button class="btn btn-primary mt-2">Save Media Management Settings</button>
    </form>
    {% endblock media_form %}

    <div class="mt-6 p-4 bg-base-200/50 rounded-xl border border-base-300">
        <h3 class="text-xs font-black uppercase tracking-widest opacity-50 mb-3">Automatic Metadata</h3>
        <div class="flex flex-wrap gap-2">
            <span class="badge badge-sm font-bold bg-base-300 border-0">metadata.json</span>
            <span class="badge badge-sm font-bold bg-base-300 border-0">metadata.opf</span>
            <span class="badge badge-sm font-bold bg-base-300 border-0">cover.jpg</span>
            <span class="badge badge-sm font-bold bg-base-300 border-0">desc.txt</span>
        </div>
    </div>
</div>
{% endblock content %}
